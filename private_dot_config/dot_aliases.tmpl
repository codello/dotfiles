#!/usr/bin/env sh
# Shell-agnostic aliases

# Enable alias expansion for watch command
alias watch='watch --color '

if command -v bat > /dev/null; then
	alias cat='bat --paging=never'
fi

if command -v gls >/dev/null; then
	alias ls="gls --color"
fi

alias la='ls -lAh'
alias ll='ls -lah'
{{- if eq .chezmoi.os "darwin" }}
alias reveal='open -R'
{{- end }}

if command -v container >/dev/null; then
  {{- if .work }}
  # There is currently an issue where DNS inside of the container doesn't work
  # when there are other services using port 53. This is a temporary workaround.
  #
  # See: https://github.com/apple/container/issues/402
  function c() {
    local _dns=$([ "$1" = "run" ] && echo "--dns=$(cat /etc/resolv.conf | grep -m1 nameserver | cut -d' ' -f2)" || true)
    container "$1" $_dns "${@:2}"
  }
  {{- end }}
  {{- if .personal }}
  alias c=container
  {{- end }}
  if [ "$ZSH_VERSION" ]; then
    compdef c=container
  fi
fi

if command -v kubectl >/dev/null; then
  alias k=kubectl
  if command -v kubecolor >/dev/null; then
    alias kubectl=kubecolor
    if [ "$ZSH_VERSION" ]; then
      compdef kubecolor=kubectl
    fi
  fi
fi

if command -v kubectl-oidc_login >/dev/null; then
  alias kubelogin=kubectl-oidc_login
  if [ "$ZSH_VERSION" ]; then
  	compdef kubectl-oidc_login=kubelogin
  fi
fi
